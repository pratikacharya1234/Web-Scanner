import React from 'react';

const renderSeverityBadge = (text) => {
  const severity = text.toLowerCase();
  if (severity.includes("high")) return <span className="bg-red-100 text-red-700 font-semibold text-xs ml-2 px-2 py-0.5 rounded-full">ğŸ”´ High</span>;
  if (severity.includes("medium")) return <span className="bg-yellow-100 text-yellow-700 font-semibold text-xs ml-2 px-2 py-0.5 rounded-full">ğŸŸ¡ Medium</span>;
  return <span className="bg-green-100 text-green-700 font-semibold text-xs ml-2 px-2 py-0.5 rounded-full">ğŸŸ¢ Info</span>;
};

export default function VulnerabilityCard({ data, onClickVuln }) {
  return (
    <div className="bg-white border border-yellow-200 p-5 rounded-xl shadow-sm">
      <h2 className="text-lg font-semibold text-yellow-800 mb-3">ğŸ›¡ï¸ Detected Vulnerabilities</h2>
      <ul className="list-disc list-inside text-sm space-y-2 text-gray-700">
        {data.map((v, i) => (
          <li
            key={i}
            onClick={() => onClickVuln && onClickVuln(v)}
            className="cursor-pointer hover:bg-yellow-50 px-2 py-1 rounded"
          >
            <div className="flex flex-col">
              <span className="font-medium text-gray-900">{v.name}</span>: {v.recommendation || 'No recommendation'}
              {renderSeverityBadge(v.recommendation || '')}
              {v.validation && (
                <span className={`text-xs mt-1 font-medium ${v.validation.includes('âœ…') ? 'text-green-700' : 'text-red-700'}`}>
                  {v.validation.includes('âœ…') ? 'âœ… Fix Passed' : 'âŒ Fix Failed'} â€” {v.validation.replace(/^(âœ…|âŒ)\s*/, '')}
                </span>
              )}
            </div>
          </li>
        ))}
      </ul>
    </div>
  );
}
